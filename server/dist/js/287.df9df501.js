"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[287],{215:function(e,a,r){r.r(a),r.d(a,{default:function(){return T}});r(4114);var t=r(6768),o=r(4232),i=r(144),s=r(4549),l=r(1380),n=r(686),c=(r(1684),r(8992),r(2577),r(5130)),d=r(1387),u=r(8238),m=r(8294),p=r(6807);const _={class:"add-item-form-container"},g={enctype:"multipart/form-data",method:"post",action:"/update_photo"},f={class:"profile"},b=["src"],y={for:"file"},k={class:"add-item-form"},v={class:"form-group"},h={class:"err"},L={class:"form-group"},R={class:"err"},C={class:"form-group"},E={class:"form-group"},w={class:"err"},I={key:0,class:"form-group"},x={class:"err"},S={class:"form-group"};var A={__name:"EditItems",setup(e){const a=(0,d.lq)(),r=(0,d.rd)(),s=(0,u.j)(),l=(0,m.e)();let n=(0,i.KR)(null),A=(0,i.KR)("");const F=a.params.item_name;let P=(0,i.Kh)([]),q=(0,i.Kh)({name_err:"",price_err:"",description_err:"",category_err:"",sub_category_err:"",image_err:""});function U(e){P=l.items.find((a=>a.name.toLowerCase()===e.toLowerCase())),P||r.push({name:"dashboard"})}function V(){let e=/^[A-Za-z\s]+$/;if(""===P.name)q.name_err="Please fill the field";else{if(e.test(P.name))return q.name_err="",!0;q.name_err="Item name can only contain letters and spaces"}}function D(){if(""!==P.price)return q.price_err="",!0;q.price_err="Please fill field"}function T(){if(""!==P.category&&"Select Category"!=P.category)return"africana"!==P.category?(P.sub_category="none",q.category_err="",!0):(q.category_err="",!0);q.category_err="Please fill field"}function W(){if(""!==P.sub_category&&"Select Sub Category"!=P.sub_category)return q.sub_category_err="",!0;q.sub_category_err="Please fill field"}function X(){if(!(P.description.length>=200))return n.value.attributes[2].nodeValue="color: gray;",!0;P.description=P.description.slice(0,200),n.value.attributes[2].nodeValue="color: red;"}async function j(){const e=A.value;if(!e.files[0])return s.backend_message="Please upload an image",void s.display_error_alert_box();if("image/png"!=e.files[0].type&&"image/jpeg"!=e.files[0].type&&"image/jpg"!=e.files[0].type)return s.backend_message="Invalid file",void s.display_error_alert_box();if(e.files[0].size>5242880)return s.backend_message="image cannot be larger than 5mb",void s.display_error_alert_box();const a=new FormData;a.append("current_image_name",P.image),a.append("item_name",F),a.append("image",e.files[0]),s.toggle_loading_overlay(!0);try{const e=await p.A.update_photo(a);"success"===e.message?(await l.fetch_items(),P.image=e.image,s.backend_message="Photo Changed Succesfully",s.display_success_alert_box()):(s.backend_message="Error occurred, please try again",s.display_error_alert_box())}catch(r){s.backend_message="Error occurred, please try again",s.display_error_alert_box()}finally{s.toggle_loading_overlay(!1)}}async function B(e){if(V()&&D()&&T()&&W()&&X()){s.toggle_loading_overlay(!0);try{const e=await p.A.update_item({...P,current_item_name:F});"success"===e.message?(await l.fetch_items(),s.backend_message="Item uploaded successfully",s.display_success_alert_box()):(s.backend_message="Error occurred, please try again",s.display_error_alert_box())}catch(a){s.backend_message="Error occurred, please try again",s.display_error_alert_box()}finally{s.toggle_loading_overlay(!1)}}}return U(F),(0,t.$u)((()=>{V(),D(),X(),T(),W()})),(e,a)=>{const r=(0,t.g2)("font-awesome-icon");return(0,t.uX)(),(0,t.CE)("div",_,[(0,t.Lk)("form",g,[(0,t.Lk)("div",f,[(0,t.Lk)("img",{src:"https://admin.kelvinspice.com.ng/images/"+(0,i.R1)(P).image,id:"profile_photo"},null,8,b),(0,t.Lk)("label",y,[(0,t.bF)(r,{style:{"font-size":"14px"},class:"fa-solid fa-camera",icon:"fa-solid fa-camera"}),a[5]||(a[5]=(0,t.eW)(" Change Photo ")),(0,t.Lk)("input",{type:"file",onChange:j,id:"file",name:"image",ref_key:"itemImage",ref:A,accept:"image/*"},null,544)])])]),(0,t.Lk)("form",k,[(0,t.Lk)("div",v,[a[6]||(a[6]=(0,t.Lk)("label",{for:"item-name",class:"form-label"},"Item Name",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"item-name","onUpdate:modelValue":a[0]||(a[0]=e=>(0,i.R1)(P).name=e),class:"form-input",placeholder:"Enter item name",required:""},null,512),[[c.Jo,(0,i.R1)(P).name]]),(0,t.Lk)("p",h,(0,o.v_)((0,i.R1)(q).name_err),1)]),(0,t.Lk)("div",L,[a[7]||(a[7]=(0,t.Lk)("label",{for:"item-price",class:"form-label"},"Item Price",-1)),(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>(0,i.R1)(P).price=e),id:"item-price",class:"form-input",placeholder:"Enter item price",required:""},null,512),[[c.Jo,(0,i.R1)(P).price]]),(0,t.Lk)("p",R,(0,o.v_)((0,i.R1)(q).price_err),1)]),(0,t.Lk)("div",C,[a[8]||(a[8]=(0,t.Lk)("label",{for:"item-description",class:"form-label"},"Item Description",-1)),(0,t.bo)((0,t.Lk)("textarea",{id:"item-description","onUpdate:modelValue":a[2]||(a[2]=e=>(0,i.R1)(P).description=e),class:"form-input",placeholder:"Enter item description",rows:"4",required:""},null,512),[[c.Jo,(0,i.R1)(P).description]]),(0,t.Lk)("p",{class:"err",style:{color:"gray"},ref_key:"description_counter",ref:n},(0,o.v_)((0,i.R1)(P).description.length)+"/200 characters",513)]),(0,t.Lk)("div",E,[a[10]||(a[10]=(0,t.Lk)("label",{for:"item-category",class:"form-label"},"Item Category",-1)),(0,t.bo)((0,t.Lk)("select",{id:"item-category","onUpdate:modelValue":a[3]||(a[3]=e=>(0,i.R1)(P).category=e),class:"form-input",required:""},a[9]||(a[9]=[(0,t.Fv)('<option value="" data-v-48d3bc4c>Select Category</option><option value="meals/sides" data-v-48d3bc4c>Meals/sides</option><option value="africana" data-v-48d3bc4c>Africana Dish</option><option value="drinks" data-v-48d3bc4c>Drinks</option><option value="bread" data-v-48d3bc4c>Bread</option><option value="cakes" data-v-48d3bc4c>Cakes</option><option value="snacks" data-v-48d3bc4c>Snacks</option>',7)]),512),[[c.u1,(0,i.R1)(P).category]]),(0,t.Lk)("p",w,(0,o.v_)((0,i.R1)(q).category_err),1)]),"africana"===(0,i.R1)(P).category?((0,t.uX)(),(0,t.CE)("div",I,[a[12]||(a[12]=(0,t.Lk)("label",{for:"item-category",class:"form-label"},"Sub Category",-1)),(0,t.bo)((0,t.Lk)("select",{id:"item-category","onUpdate:modelValue":a[4]||(a[4]=e=>(0,i.R1)(P).sub_category=e),class:"form-input",required:""},a[11]||(a[11]=[(0,t.Lk)("option",{value:""},"Select Sub Category",-1),(0,t.Lk)("option",{value:"swallow"},"Swallow",-1),(0,t.Lk)("option",{value:"soup"},"Soup",-1),(0,t.Lk)("option",{value:"none"},"None",-1)]),512),[[c.u1,(0,i.R1)(P).sub_category]]),(0,t.Lk)("p",x,(0,o.v_)((0,i.R1)(q).sub_category_err),1)])):(0,t.Q3)("",!0),(0,t.Lk)("div",S,[(0,t.Lk)("button",{type:"submit",onClick:(0,c.D$)(B,["prevent"]),class:"submit-button"},[(0,t.RG)(e.$slots,"button-title")])])])])}}},F=r(1241);const P=(0,F.A)(A,[["__scopeId","data-v-48d3bc4c"]]);var q=P,U=r(1556),V={__name:"Edit-Item",setup(e){const a=(0,u.j)(),r=(0,s.g)(),c=((0,d.lq)(),(0,d.rd)());return r.admin_isAuthenticated||c.push({path:"/login"}),(0,t.wB)((()=>r.admin_isAuthenticated),(e=>{e||(a.backend_message="session expired",a.display_success_alert_box(!0),setTimeout((()=>{c.push({path:"/login"})}),1e3))})),(e,r)=>{const s=(0,t.g2)("SUCCESSALERTBOX"),c=(0,t.g2)("ERRORALERTBOX");return(0,t.uX)(),(0,t.CE)("div",{class:"container",style:(0,o.Tr)((0,i.R1)(a).container_css)},[(0,t.bF)(n.A),(0,t.bF)(s,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)((0,i.R1)(a).backend_message),1)])),_:1}),(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)((0,i.R1)(a).backend_message),1)])),_:1}),(0,t.bF)(U.A),(0,t.Lk)("div",{class:"sub_container",style:(0,o.Tr)((0,i.R1)(a).sub_container_css)},[(0,t.bF)(l.A,{page_name:"edit-item"}),r[2]||(r[2]=(0,t.Lk)("h1",null,"Edit Item",-1)),(0,t.bF)(q,null,{"form-title":(0,t.k6)((()=>r[0]||(r[0]=[(0,t.eW)(" Edit Item ")]))),"button-title":(0,t.k6)((()=>r[1]||(r[1]=[(0,t.eW)(" Update Item ")]))),_:1})],4)],4)}}};const D=(0,F.A)(V,[["__scopeId","data-v-d9b212c8"]]);var T=D}}]);
//# sourceMappingURL=287.df9df501.js.map